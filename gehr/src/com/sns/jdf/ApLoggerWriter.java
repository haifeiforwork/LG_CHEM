package com.sns.jdf;import java.io.*;import java.util.Date;import hris.common.WebUserData;public final class ApLoggerWriter{	public static void writeApLog(String menuNm, String subMenuNm, String pgmId, String pgmNm, String ctrl, String cnt, String[] val, WebUserData user, String userIp) throws Exception{		try{			StringBuffer apLog = new StringBuffer("");	//로그내용			long time = System.currentTimeMillis();			java.text.SimpleDateFormat dayTime = new java.text.SimpleDateFormat("yyyyMMddHHmmssSSS");			java.text.SimpleDateFormat  vants   = new java.text.SimpleDateFormat( "yyyyMMdd");			String fileNm = vants.format(new Date(time));	//로그파일명			String dateTime = dayTime.format(new Date(time));	//시간			String userId = user.webUserId;	//조작자ID			String userNm = user.ename;	//조작자명			Config conf = new Configuration();			String server = "prd";	//운영개발 (운영 : prd / 개발 : dev )			if(conf.getBoolean("com.sns.jdf.eloffice.ISDEVELOP")){				server = "dev";			}			String sysIp = conf.get("com.sns.jdf.apLog.sysIp");	//시스템IP			String sysPort = conf.get("com.sns.jdf.apLog.sysPort");	//시스템포트			String sysId = conf.get("com.sns.jdf.apLog.sysId");	//업무시스템ID			String sysSeq = conf.get("com.sns.jdf.apLog.sysSeq");	//업무시스템SEQ			String sep = "|";	//구분자			//입력값 작성			StringBuffer inputVal = new StringBuffer("");	//입력값			String inputSep = "`";	//입력값구분자			if(val!=null){				for(int i=0;i<val.length;i++){					if(i>0){						inputVal.append(inputSep);						inputVal.append(val[i]);					} else {						inputVal.append(val[i]);					}				}			}			//apLog 만들기			//시간+대메뉴명+서브메뉴명+프로그램ID+프로그램명+조작자IP+조작자ID+조작자명			//+업무시스템ID+업무SEQ+운영개발+시스템IP+시스템포트+조작구분+처리건수+입력값			//+temp 1+temp 2+temp 3+개행문자(\n)			String[] logs = new String[]{dateTime, menuNm, subMenuNm, pgmId, pgmNm, userIp, userId, userNm, 													sysId, sysSeq, server, sysIp, sysPort, ctrl, cnt, inputVal.toString(), 													"", "", "", "/n"};			for(int j=0;j<logs.length;j++){				if(j>0){					apLog.append(sep);					apLog.append(logs[j]);				} else {					apLog.append(logs[j]);				}			}						writeToFileLog(apLog.toString(), fileNm);		}  catch( Exception e )  {           // Logger.error(e);        	Logger.debug.println( "Can Not WriteApLog - Exception :"+e.toString() );        }	}	/**	 * 파일에 로그 생성 - file에 log를 insert하기 위함	 * @param : str		 * @return 	 */    private static void writeToFileLog(String str, String fileNm) {		String LOG_FILE =  "/sorc001/gehr/gehr.ear/gehrWeb.war/aplog/Aplog-"+fileNm+".log";		File destination = new File(LOG_FILE);	//폴더가 존재하여야 생성함.    	try  {    		//하나의 파일에 로그를 계속 첨부하여 생성    		BufferedWriter writer = new BufferedWriter(new FileWriter(destination, true));    		writer.write(str);    		writer.newLine();    		writer.close();        } catch( Exception e )  {            //Logger.error(e);        	Logger.debug.println( "Can Not WritetoFileLog - Exception :"+e.toString() );        }    }    }