<%/***************************************************************************************//*   System Name  	: g-HR              																												*//*   1Depth Name  	: Organization & Staffing                                               														*//*   2Depth Name  	: Personnel Info                                               																*//*   Program Name 	: Expiry of Contract                                  																		*//*   Program ID   		: F72ExpiryOfContractExcelUsa.jsp                             															*//*   Description  		: 계약만료현황 정보 Excel 저장을 위한 위한 jsp 파일 (USA - LGCPI(G400))                                       	*//*   Note         		:                                                         																			*//*   Creation			: 2010-11-05 jungin @v1.0 LGCPI법인 전용 페이지 신규 개발														*//*   Update       :2017/08/28 eunha [CSR ID:3456352] 직급체계개편 후 직위/직책 표시 기준 변경에 따른 시스템 변경 요청 건      *//***************************************************************************************/%><%@ page contentType="text/html; charset=utf-8" %><%@ include file="../common/commonProcess.jsp" %><%@ taglib prefix="spring" uri="http://www.springframework.org/tags" %><%@ page import="java.util.Vector" %><%@ page import="hris.common.*" %><%@ page import="hris.common.rfc.*" %><%@ page import="hris.common.util.*" %><%@ page import="hris.F.*" %><%@ page import="hris.F.rfc.*" %><%	request.setCharacterEncoding("utf-8");    WebUserData user = (WebUserData)session.getAttribute("user");            	// 세션    String deptId = WebUtil.nvl(request.getParameter("hdn_deptId"));  			// 부서코드    String deptNm = (WebUtil.nvl(request.getParameter("hdn_deptNm")));		// 부서명    Vector Dept4YearValuation_vt = (Vector)request.getAttribute("Dept4YearValuation_vt");    /*----- Excel 파일 저장하기 --------------------------------------------------- */    response.setHeader("Content-Disposition","attachment;filename=Expiry_Contract_Result.xls");    response.setContentType("application/vnd.ms-excel;charset=utf-8");    /*----------------------------------------------------------------------------- */%><html><head><title>MSS</title><meta http-equiv=Content-Type content="text/html; charset=utf-8"><meta name=ProgId content=Excel.Sheet><meta name=Generator content="Microsoft Excel 9"></head><body bgcolor="#FFFFFF" text="#000000" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0"><form name="form1" method="post"><%    if (Dept4YearValuation_vt != null && Dept4YearValuation_vt.size() > 0) {%><table width="1200" border="0" cellspacing="0" cellpadding="0" align="center">  <tr>    <td width="16">&nbsp;</td>    <td >      <table width="100%" border="0" cellspacing="0" cellpadding="0" align="center">        <tr>          <td colspan="5" class="title02">* <spring:message code="LABEL.F.F72.0016" /><!-- Expiry of Contract --></td><td></td>        </tr>        <tr><td height="10"></td><td></td></tr>        <tr>	      <td colspan="5" class="td09">&nbsp;<spring:message code="LABEL.F.F72.0004" /><!-- Org.Unit --> : <%=WebUtil.nvl(deptNm, user.e_obtxt)%></td>          <td colspan="6"  class="td08" style="text-align:right">&lt;<spring:message code="LABEL.F.F72.0018" /><!-- Total Count -->:<%=Dept4YearValuation_vt.size()%>&gt;&nbsp;</td>	    </tr>	    <tr><td height="10"></td></tr>      </table>    </td>    <td width="16">&nbsp;</td>  </tr>  <tr>    <td width="16">&nbsp;</td>    <td >        <table  border="1" cellspacing="1" cellpadding="4" class="table02">          <tr>            <td class="td03" nowrap><spring:message code="LABEL.F.F72.0001" /><!-- Corp. --></td>            <td class="td03" nowrap><spring:message code="LABEL.F.F72.0002" /><!-- Pers.No --></td>            <td class="td03" nowrap><spring:message code="LABEL.F.F72.0003" /><!-- Name --></td>            <td class="td03" nowrap><spring:message code="LABEL.F.F72.0004" /><!-- Org.Unit --></td>            <td class="td03" nowrap><spring:message code="LABEL.F.F72.0005" /><!-- Res.of Office --></td>            <%--CSR ID:3456352] 직급체계개편 후 직위/직책 표시 기준 변경에 따른 시스템 변경 요청 건 start--%>            <%--<td class="td03" nowrap><spring:message code="LABEL.F.F72.0006" /><!-- Title of Level --></td> --%>            <td class="td03" nowrap><spring:message code='MSG.A.A01.0083'/><!-- 직위/직급호칭 --></td>            <%--CSR ID:3456352] 직급체계개편 후 직위/직책 표시 기준 변경에 따른 시스템 변경 요청 건 end--%>            <td class="td03" nowrap><spring:message code="LABEL.F.F72.0007" /><!-- Level / Annu. --></td>            <td class="td03" nowrap><spring:message code="LABEL.F.F72.0008" /><!-- Hiring Date --></td>            <td class="td03" nowrap><spring:message code="LABEL.F.F72.0009" /><!-- Start Date --></td>            <td class="td03" nowrap><spring:message code="LABEL.F.F72.0010" /><!-- End Date --></td>            <td class="td03" nowrap><spring:message code="LABEL.F.F72.0011" /><!-- Duration<br>(Month) --></td>            <td class="td03" nowrap><spring:message code="LABEL.F.F72.0012" /><!-- Contract Type --></td>            <td class="td03" nowrap><spring:message code="LABEL.F.F72.0013" /><!-- Agency --></td>            <td class="td03" nowrap><spring:message code="LABEL.F.F72.0014" /><!-- Bill Rate --></td>            <td class="td03" nowrap><spring:message code="LABEL.F.F72.0015" /><!-- OT Bil Rate --></td>          </tr><%            for( int i = 0; i < Dept4YearValuation_vt.size(); i++ ){                F72ExpiryOfContractDataEurp data = (F72ExpiryOfContractDataEurp)Dept4YearValuation_vt.get(i);                int duRat;                duRat = Integer.parseInt(data.DURAT);%>          <tr align="center">	        <td class="td09" nowrap>&nbsp;<%= data.NAME1 %>&nbsp;</td>            <td class="td09" nowrap>&nbsp;<%= data.PERNR %>&nbsp;</td>            <td class="td09" nowrap>&nbsp;<%= data.ENAME %>&nbsp;</td>            <td class="td09" nowrap>&nbsp;<%= data.ORGTX %>&nbsp;</td>            <td class="td09" nowrap>&nbsp;<%= data.JIKKT %>&nbsp;</td>            <td class="td09" nowrap>&nbsp;<%= data.JIKWT %>&nbsp;</td>            <td class="td09" nowrap>&nbsp;<%= data.JIKCT %> / <%= data.ANNUL %>&nbsp;</td>            <td class="td09" nowrap>&nbsp;<%= (data.DAT01).replace("-","").replace(".","").equals("00000000") ? "" : WebUtil.printDate(data.DAT01) %>&nbsp;</td>            <td class="td09" nowrap>&nbsp;<%= (data.BEGDA).replace("-","").replace(".","").equals("00000000") ? "" : WebUtil.printDate(data.BEGDA) %>&nbsp;</td>            <td class="td09" nowrap>&nbsp;<%= (data.ENDDA).replace("-","").replace(".","").equals("00000000") ? "" : WebUtil.printDate(data.ENDDA) %>&nbsp;</td>            <td class="td09" nowrap style="text-align:center;">&nbsp;<%= duRat %>&nbsp;</td>            <td class="td09" nowrap>&nbsp;<%= data.CTTXT %>&nbsp;</td>            <td class="td09" nowrap>&nbsp;<%= data.STEXT %>&nbsp;</td>            <td class="td09" nowrap style="text-align:right;">&nbsp;<%= WebUtil.printNumFormat(data.BILRTE,2) %>&nbsp;</td>            <td class="td09" nowrap style="text-align:right;">&nbsp;<%= WebUtil.printNumFormat(data.OTBRTE,2) %>&nbsp;</td>          </tr><%	        } //end for.%>        </table>    </td>    <td width="16">&nbsp;</td>  </tr>  <tr><td height="16"></td></tr></table><%    } else {%><table width="780" border="0" cellspacing="0" cellpadding="0" align="center">  <tr align="center">    <td  class="td04" align="center" height="25" ><spring:message code="LABEL.F.F51.0029" /><!-- No data --></td>  </tr></table><%    } //end if.%></form></body></html>